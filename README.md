# Project_TravelBookingDatabase

Project Final Report

Travel Booking Database Development

May 31, 2023


## TABLE OF CONTENTS

I. IMPLEMENTATION OVERVIEW

II. DATA SOURCE

III. DATA PREPROCESSING THROUGH PYTHON

IV. DATA SOURCE LAYER

V. DATA MAINTENANCE

VI. DATA STORAGE LAYER

A. RELATIONAL MODEL

B. GRAPH MODEL

C. DOCUMENT MODEL

VII. DATA MART LAYER

VIII. APPENDIX

## PART I. IMPLEMENTATION OVERVIEW

![overview](/ArchitectureDiagram.png)

## PART II. DATA SOURCE

We obtained data from multiple sources. The airline, airport, route, and country data were
collected from the website OpenFlights . The flight data was retrieved from the Bureau of
Transportation Statistics. The flight rating data is from Kaggle, and the customer data was
generated by ourselves.

## PART III. DATA PREPROCESSING THROUGH PYTHON

### A. Data Source
Airport_raw.csv; Airline_raw.csv; Route_raw.csv; Country_raw.csv; Flight_raw.csv;
Rating_raw.csv; Users_raw.csv

### B. Preprocessing Process
Since most of our data is from the real world, the raw data is quite messy. We chose to
use Python to conduct some data cleaning.
The cleaning steps includes:
- Selecting out columns needed to store in the database. Some raw datasets
contain many redundant columns that are irrelevant to our project topic.
-  Rename column to match our database DDL.
- Check if there are null values in not-null columns. Check unique values in
columns that have unique constraints.
- Encoding categorical columns. For instance, mapping ‘satisfied’ to 1 and
‘dissatisfied’ to 0.

### C. Code
ETL_Python.ipynb: Python code for data preprocessing

## PART IV. DATA SOURCE LAYER

### A. Tables (QICC.SRC)
SRC.Airline, SRC.Airport, SRC.City, SRC.Country, SRC.Flight, SRC.Plane,
SRC.User, and SRC.Rating.

### B. Data Import
After preprocessing the data, the output csv files were uploaded to corresponding
tables in the database source layer (QICC.SRC). Since most of our group members
use the Mac system, we chose DBeaver for data import. During import, we added a
timestamp field to indicate the last update time. As DBeaver does not support table
join while importing data to each table, tables in the Source layer are not connected
through foreign keys, which is why we need to perform table joins while loading the
data from the source layer to the storage layer.

### C. Data Export
There are two conditions while loading data from the source layer to corresponding
tables in the storage layer. The first condition is when the table does not have any
foreign key. In this case, we could directly use DBeaver’s Import Data feature and
choose import from other tables. The second condition is when the table has foreign
keys, which means that we need to perform a join with the parent entity in the storage
layer to obtain the foreign key. This is implemented through stored procedures. Take
the LoadCity stored procedure as an example. This stored procedure is to load data
from the SRC.City table to the TBL.City table. Since the TBL.City table has a foreign
key CountryID, we joined the SRC.City table with TBL.Country table on
CountryName, and thus obtained the CountryID as the foreign key.

### D. Code
SRC_DDL.sql: DDL SQL code for tables in the source layer
Batch&StreamingETL.sql: SQL code for ETL stored procedures and trigger

## PART V. DATA MAINTENANCE

### A. Batch Incremental ETL
The stored procedures mentioned above are also used for data refresh and
maintenance. We added a parameter @LastLoadTime in each stored procedure. By
comparing @LastLoadTime with the timestamp field of each table in the source layer,
we could extract data that has been inserted since the last loading, and thus achieve
incremental data loading.

### B. Streamline ETL
We further implemented a simple insert trigger to automate the data refreshing. The
trigger is placed on the SRC.Flight table since flight is the table that could have the
most frequent data insertion. Whenever an entry is inserted into the SRC.Flight table,
the entry will automatically be inserted to TBL.Flight table.

## PART VI. DATA STORAGE LAYER

### A. Relational Model (QICC.TBL)

#### a. Tables & View:
TBL.Airline, TBL.Airport, TBL.City, TBL.Country, TBL.Flight, TBL.Plane,
TBL.User, TBL.Rating, TBL.VW_RouteInfo;

#### b. Code:
TBL_DDL.sql: DDL SQL Code for relational tables in the storage layer.
Views.sql: SQL Code for one view in the relational model.

#### c. Relational ERD:
![erd](/RelationalModel.png)

### B. Graph Model (QICC.GRF)

#### a. Tables
Node Table: GRF.Airport
Edge Table: GRF.Route

#### b. Graph Design
![graph](/GraphModel.png)

#### c. GRF.FindPath Function

- Functionality: Find paths from origin to destination within 2 routes
- Input: AirportName A, AirportName B
- Output: All paths with less than 2 routes
- Example: SELECT * FROM GRF.FindPath('Seattle Tacoma International
Airport', 'Beijing Capital International Airport')

#### d. Code
GRF_DDL.sql: DDL SQL code for Graph model

### C. Document Model (QICC.DOC)

#### a. Table
DOC.UserDocExample: this table stores some examples of our user-based
document json file.

#### b. User-based Document Model
The document model stores all information related to one user, including
booking details, route details, datetime details, and rating details of the user’s
each flight record.

#### c. Multi-Model Query
We developed a Multi-Model query to combine these three models. We first
generated a json file containing all flights in 2023. Afterwards, we use this
multi-model query to find out different airlines' average departure delay and
average arrival delay of all flights that fly from Seattle Tacoma Airport in
2023.

## PART VII. DATA MART LAYER

### A. DM_Airline

#### a. Routes Details
This table increases redundancies by adding the origin & destination airport
names & city names to the route data, which will be convenient for reference.

#### b. Airline ratings
This table provides the average ratings for all services provided by airlines
using the data from all consumers. This data will help airlines improve their
services

#### c. Cancellation Rate by Quarter
This table provides information on the quarterly flight cancellation rate for
each airline. It serves as a valuable resource for customers in evaluating the
overall reliability of airlines, allowing them to make informed decisions with
respect to flight cancellation risk when selecting an airline for travel. By
examining the trends in cancellation rates over quarters, airlines can also
identify patterns in performance and devise strategies to minimize flight
cancellations accordingly.

#### d. New Customers by Quarter
This table provides valuable insights into acquisition of new customers by
quarter for each airline. It helps monitor and track the airline performance
over time, with respect to the growth of customer bases. This allows airlines
to gauge their performance in acquiring new customers and to make
data-driven decisions in enhancing their customer acquisition strategies.

#### e.Returning Customers by Quarter
This table captures the data on quarterly returning customers for each airline,
highlighting customer loyalty and retention for different airlines over time. It
offers insight into customer behavior and preferences, allowing us to analyze
the effectiveness of customer retention strategies or loyalty programs.

### B. DM_Airport

#### a.Average Delay by Month

This table presents the average time of departure delays in different airports on
a monthly basis. Data is sorted so that the departure airport with the most
delays in a month will be presented first. This might provide useful
information for travelers when they plan future trips, and for airports to
manage their resources.

#### b.Average Departure and Arrival Delay by Airport
This table contains the average departure and arrival delays in minutes for
each airport, with positive numbers indicating delays and negative numbers
indicating early arrivals. This information can help airports better understand
overall operational performance, and if there are significant delays, then the
airport management team should analyze the issue and explore improvement
measures.

#### c.Airport Busyness by Quarter
This table tracks the number of flights to and from each airport in each quarter
of the year. This information can be useful for airport management teams
because they can refer to it to optimize the overall operations based on the
peak season of the year, such as adding more staff, opening more check-in
counters, etc.

### C. DM_Passenger

#### a.Top Travel Destination by Quarter
This table provides the most popular destination cities in each quarter. Number
of passengers visiting the cities, ranking in terms of popularity, along with
countries where cities are located have been included in this table.

#### b.Travel Type by Routes
This table shows the percentage of business travelers and personal travelers in
each route, by averaging numbers of these two types of travelers in all
historical flights of each route. It will provide useful insights for airlines, as
they can provide tailored services according to the composition of travelers in
a certain route

### D. DM_Plane

#### a.Popular Plane by Quarter
This table shows the most popular planes in use in each quarter. Plane name
and plane ICAO, as well as counts and ranking of service times are included.
This table may provide useful insights for plane manufacturers about the
popularity of their products.

### E. DM_Route

#### a.On-Time Performance
This table contains information about the on-time performance for each route,
measured by the on-time rate. It facilitates the analysis on the effectiveness of
different flight routes, allowing us to determine the most efficient route
options for travelers. By identifying routes with consistently high on-time
rates, airlines can optimize their route offerings, improving overall operational
efficiency while enhancing customer satisfaction.
